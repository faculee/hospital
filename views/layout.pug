doctype html
html(lang="es")
  head
    meta(charset="UTF-8")
    meta(name="viewport", content="width=device-width, initial-scale=1.0")
    title Admisión Hospitalaria
    link(rel="stylesheet", href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css")
    link(rel="stylesheet", href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css")

    style.
      html, body {
        height: 100%;
        margin: 0;
        background: linear-gradient(to right, #4facfe, #00f2fe);
        display: flex;
        flex-direction: column;
      }
      main.container {
          background: transparent !important;
      }
      .navbar-dark .navbar-nav .nav-link { color: white; }
      .navbar-nav .dropdown-menu { background-color: #1c1c1c; border: none; }
      .dropdown-menu a { color: white; }
      .dropdown-menu a:hover { background-color: rgba(224, 219, 219, 0.87); color: black; }
      .navbar-brand-centered {
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
        font-weight: bold;
      }
      .dropdown-divider {
        border-top: 1px solid rgba(255, 255, 255, 0.5);
      }

      main { flex: 1; padding-top: 70px; }
    block extraHead

  body
    - const rol = usuario?.rol;

    nav.navbar.navbar-expand-lg.navbar-dark.bg-dark.fixed-top
      .container-fluid.position-relative
        button.navbar-toggler(type="button", data-bs-toggle="collapse", data-bs-target="#navbarNav")
          span.navbar-toggler-icon

        .collapse.navbar-collapse#navbarNav
          ul.navbar-nav.me-auto.mb-2.mb-lg-0

            // Pacientes (todos los roles)
            if [1, 2, 3, 4].includes(rol)
              li.nav-item.dropdown
                a.nav-link.dropdown-toggle(href="#", role="button", data-bs-toggle="dropdown") Pacientes
                ul.dropdown-menu
                  li: a.dropdown-item(href="/pacientes") Legajos
                  li: a.dropdown-item(href="/pacienteslistado") Listados / Búsquedas
                  if [1, 3].includes(rol)
                    li: a.dropdown-item(href="/antecedentespersonales") Antecedentes Personales
                  if [1, 3, 4].includes(rol)
                    li: a.dropdown-item(href="/historiaclinica") Historia Clínica

            // Internación
            if [1, 2, 3, 4].includes(rol)
              li.nav-item.dropdown
                a.nav-link.dropdown-toggle(href="#", role="button", data-bs-toggle="dropdown") Internación
                ul.dropdown-menu
                  if [1, 2].includes(rol)
                    li: a.dropdown-item(href="/internacion") Admisión - Asignación de Camas
                  if [1, 3].includes(rol)
                    li: a.dropdown-item(href="/atencionmedica") Registro de Atención Médica
                  if [1, 4].includes(rol)
                    li: a.dropdown-item(href="/atencionenfermeria") Registro de Atención en Enfermería
                    li: hr.dropdown-divider
                  if [1, 2, 3, 4].includes(rol)
                    li: a.dropdown-item(href="/infraestructura/camas-ocupadas") Detalle de Ocupación de Camas
                  if [1, 2, 3, 4].includes(rol)
                    li: a.dropdown-item(href="/infraestructura/camas-ocupacion-porcentaje") % de Ocupación por Unidad
                  if [1].includes(rol)
                    li: hr.dropdown-divider                    
                    li: a.dropdown-item(href="/internacioncambiarpaciente") Asociar internación a otro paciente
            // Sistema (solo admin)
            if rol === 1
              li.nav-item.dropdown
                a.nav-link.dropdown-toggle(href="#", role="button", data-bs-toggle="dropdown") Sistema
                ul.dropdown-menu
                  li: a.dropdown-item(href="/medicos") Médicos
                  li: a.dropdown-item(href="/enfermeros") Enfermeros
                  li: a.dropdown-item(href="/usuarios") Usuarios
                  li: a.dropdown-item(href="/coberturas") Coberturas
                  li: a.dropdown-item(href="/medicamentos") Medicamentos
                  li: hr.dropdown-divider
                  li: a.dropdown-item(href="/enfermeroslistado") Listado de Enfermeros
                  li: a.dropdown-item(href="/medicoslistado") Listado de Médicos
                  li: hr.dropdown-divider
                  li: a.dropdown-item(href="/infraestructura") Infraestructura

        a.navbar-brand.text-white.navbar-brand-centered(href="#") Admisión Hospitalaria

        div.d-flex.align-items-center.position-absolute.end-0.me-3
          if usuario
            span.text-white.me-3
              i.bi.bi-person-fill.me-1
              | #{usuario.nombre}
            a.btn.btn-sm.btn-outline-light.me-2(href="/cambiarpassword") Cambiar Contraseña
            a.btn.btn-sm.btn-outline-light(href="/login/logout") Cerrar sesión
          else
            a.btn.btn-sm.btn-outline-light(href="/login") Iniciar sesión

    main.container.mt-4
      block content

    script(src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js")
    script.
      function actualizarFechaHora() {
        const fechaHoraElement = document.getElementById("fechaHora");
        if (!fechaHoraElement) return;
        const fecha = new Date();
        const opciones = {
          weekday: 'long',
          year: 'numeric',
          month: 'long',
          day: 'numeric',
          hour: '2-digit',
          minute: '2-digit',
          second: '2-digit'
        };
        fechaHoraElement.textContent = fecha.toLocaleDateString('es-ES', opciones);
      }
      setInterval(actualizarFechaHora, 1000);

    block extraScripts
